@page
@model DevBin.Pages.User.LoginModel
@{
    ViewData["Title"] = "Login";
}

<div class="my-4 row">
    <div class="offset-md-1 col-md-4">
        <form method="post" action="/user/login">
            <h4>Login</h4>
            <label for="email-field">Email Address</label>
            <div class="input-group mb-3">
                <span class="input-group-text">
                    <i class="far fa-envelope"></i>
                </span>

                <input type="email" id="login-email-field" class="form-control" aria-label="Email Address" aria-describedby="email-field" required autocomplete="on">
                <div class="invalid-feedback">
                    Invalid address
                </div>
            </div>

            <label for="password-field">Password</label>
            <div class="input-group mb-3">
                <span class="input-group-text">
                    <i class="fas fa-key"></i>
                </span>
                <input type="password" id="login-password-field" class="form-control" aria-label="Password" aria-describedby="password-field" required spellcheck="false" autocorrect="off" autocapitalize="off">
                <button class="input-group-text" type="button" onmousedown="showPassword('login-password-field');" onmouseup="hidePassword('login-password-field');" onmouseleave="hidePassword('login-password-field');">
                    <i class="fas fa-eye"></i>
                </button>
                <div class="invalid-feedback">
                    Too short
                </div>
            </div>

            <button type="submit" class="btn btn-primary">Login</button>
        </form>
    </div>

    <div class="col-md-4 offset-md-2">
        <form method="post" action="/user/signup">
            <h4>Sign Up</h4>
            <label for="email-field">Email Address</label>
            <div class="mb-3">
                <div class="input-group">
                    <span class="input-group-text" id="email-label">
                        <i class="far fa-envelope"></i>
                    </span>
                    <input type="email" id="email-field" class="form-control" aria-label="Email Address" aria-describedby="email-field" required>
                </div>
                <div class="form-text text-light">Used for validation of the account</div>
            </div>

            <label for="username-field">Username</label>
            <div class="mb-3">
                <div class="input-group">
                    <span class="input-group-text" id="username-label">@@</span>
                    <input type="text" id="username-field" class="form-control" aria-label="Username" aria-describedby="username-field" required>

                </div>
            </div>

            <label for="password-field">Password</label>
            <div class="mb-3">
                <div class="input-group">
                    <span class="input-group-text" id="password-label">
                        <i class="fas fa-key"></i>
                    </span>
                    <input type="password" id="password-field" class="form-control" aria-label="Password" aria-describedby="password-field" required>
                    <button class="input-group-text" type="button" id="view-password" onmousedown="showPassword('password-field');" onmouseup="hidePassword('password-field');" onmouseleave="hidePassword('password-field');">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <div class="form-text text-light">Should contain at least 8 characters</div>
            </div>

            <button type="submit" class="btn btn-primary">Sign Up</button>
        </form>
    </div>

</div>

<script>
    function showPassword(id) {
        let passwordField = document.getElementById(id);
        passwordField.type = "text";
    }
    
    function hidePassword(id) {
        let passwordField = document.getElementById(id);
        passwordField.type = "password";
        }
</script>

<script>

function validateEmail(email) {
    const re = /^(([^<>()\[\]\\.,;:\s@@"]+(\.[^<>()\[\]\\.,;:\s@@"]+)*)|(".+"))@@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(String(email).toLowerCase());
}

function switchValidation(el, valid) {
    if(valid) {
        el.classList.remove("is-invalid");
        el.classList.add("is-valid");
    } else {
        el.classList.remove("is-valid");
        el.classList.add("is-invalid");
    }
}

function validateLogin() {
    let emailField = document.getElementById("login-email-field");
    let passwordField = document.getElementById("login-password-field");
    
    switchValidation(emailField, validateEmail(emailField.value));
    switchValidation(passwordField, passwordField.value.length >= 8)
}
</script>